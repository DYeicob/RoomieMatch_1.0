<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoomieMatch - Find Your Ideal Flatmate</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script type="importmap">
    {
        "imports": {
            "lit-html": "https://cdn.jsdelivr.net/npm/lit-html@3.1.2/lit-html.js",
            "lit-html/": "https://cdn.jsdelivr.net/npm/lit-html@3.1.2/"
        }
    }
    </script>
</head>
<body>
    <div id="app-container">
        </div>

    <div id="modal-root"></div>

    <footer>
        <div class="container">
            <p>&copy; 2025 RoomieMatch. All rights reserved.</p>
            <p>Connecting people, creating homes.</p>
        </div>
    </footer>

    <script type="module">
import { html, render } from 'lit-html';
import { classMap } from 'lit-html/directives/class-map.js';

// --- INLINED DATA FROM data.js ---
const initialProfiles = [
  {
    id: 1,
    name: 'Ana García',
    age: 24,
    city: 'Madrid',
    bio: 'Master\'s student in graphic design. I am tidy, I like peace during the week and going out on weekends. Looking for good vibes and cleanliness.',
    budget: 550,
    tags: ['Tidy', 'Social', 'Non-smoker', 'Early bird'],
    image: 'profile1.png',
    verified: true,
    likes: [],
  },
  {
    id: 2,
    name: 'Carlos Ruiz',
    age: 29,
    city: 'Barcelona',
    bio: 'Software developer working remotely. I love cooking, video games, and cinema. Looking for a relaxed and friendly atmosphere.',
    budget: 650,
    tags: ['Quiet', 'Movie buff', 'Foodie', 'Pet friendly'],
    image: 'profile2.png',
    verified: true,
    likes: [],
  },
  {
    id: 3,
    name: 'Alex Moreno',
    age: 26,
    city: 'Valencia',
    bio: 'Freelance artist. I am a creative and night person. I enjoy deep conversations and art. Respect for space is key.',
    budget: 450,
    tags: ['Night owl', 'Creative', 'Vegan', 'LGBT+ friendly'],
    image: 'profile3.png',
    verified: false,
    likes: [],
  },
  {
    id: 4,
    name: 'Javier Soler',
    age: 31,
    city: 'Seville',
    bio: 'Marketing consultant. I spend little time at home due to work, but when I am there, I like everything to be clean and tidy. Looking for someone independent.',
    budget: 500,
    tags: ['Clean', 'Independent', 'Traveler', 'Non-smoker'],
    image: 'profile4.png',
    verified: true,
    likes: [],
  },
];

const initialListings = [
    {
        id: 1,
        userId: 1,
        title: 'Bright room in Malasaña',
        location: 'Malasaña, Madrid',
        price: 580,
        description: 'Exterior room with a balcony. Recently renovated apartment with 2 other flatmates. Looking for someone clean and social.',
        image: 'listing1.png'
    },
    {
        id: 2,
        userId: 2,
        title: 'Shared apartment in Gràcia',
        location: 'Gràcia, Barcelona',
        price: 620,
        description: 'Spacious room in a penthouse with a terrace. We are two working guys. Quiet and friendly atmosphere.',
        image: 'listing2.png'
    },
    {
        id: 3,
        userId: 3,
        title: 'Room next to Turia River',
        location: 'El Carmen, Valencia',
        price: 430,
        description: 'Single room in a student apartment. Close to universities with a great atmosphere. All bills included.',
        image: 'listing3.png'
    }
];

// --- STATE MANAGEMENT & DOM (Summary of translations in main logic) ---
// (Note: I've updated the labels and text in the templates below)

const headerTemplate = () => html`
    <header>
        <nav class="container">
            <a href="#/" class="nav-logo" @click=${handleNav}>
                <img src="logo.png" alt="RoomieMatch Logo">
                <span>RoomieMatch</span>
            </a>
            <ul class="nav-links">
                <li><a href="#/profiles" class="nav-link ${state.currentPath === '/profiles' ? 'active' : ''}" @click=${handleNav}>Find a Roomie</a></li>
                <li><a href="#/listings" class="nav-link ${state.currentPath === '/listings' ? 'active' : ''}" @click=${handleNav}>Browse Listings</a></li>
                ${state.currentUser ? html`
                    <li><a href="#/my-profile" class="nav-link ${state.currentPath === '/my-profile' ? 'active' : ''}" @click=${handleNav}>My Profile</a></li>
                    <li><a href="#/my-listings" class="nav-link ${state.currentPath === '/my-listings' ? 'active' : ''}" @click=${handleNav}>My Listings</a></li>
                ` : ''}
            </ul>
            <div class="nav-auth">
                ${state.currentUser ? html`
                    <a href="#/messages" @click=${handleNav} class="nav-icon-link" title="Messages">
                        <img src="icon-envelope.png" alt="Messages">
                    </a>
                    <span class="nav-username">Hi, ${state.currentUser.name.split(' ')[0]}</span>
                    <button @click=${handleLogout} class="btn btn-secondary">Log Out</button>
                ` : html`
                    <button @click=${() => setState({ isLoginModalOpen: true })} class="btn btn-secondary">Log In</button>
                    <button @click=${() => setState({ isRegisterModalOpen: true })} class="btn btn-primary">Sign Up</button>
                `}
            </div>
        </nav>
    </header>
`;

const loginModalTemplate = () => html`
    <div class="modal-overlay ${classMap({ active: state.isLoginModalOpen })}" @click=${closeModals}>
        <div class="modal-content" @click=${e => e.stopPropagation()}>
            <button class="modal-close" @click=${closeModals}>&times;</button>
            <h2 class="modal-title">Log In</h2>
            <form @submit=${handleLogin}>
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Enter</button>
            </form>
        </div>
    </div>
`;

const homeTemplate = () => html`
  <div class="container">
    <section class="hero">
      <div class="hero-content">
        <h1>Find your ideal flatmate</h1>
        <p>Connect with like-minded people and discover the perfect place to live. Your next great adventure starts here.</p>
        <button @click=${() => navigate('/profiles')} class="btn btn-primary btn-lg">Start Searching</button>
      </div>
    </section>
    <section class="how-it-works">
        <h2>How it works?</h2>
        <div class="steps">
            <div class="step"><h3>1. Create your profile</h3><p>Describe your lifestyle, budget, and what you are looking for in a flatmate.</p></div>
            <div class="step"><h3>2. Discover profiles</h3><p>Our algorithm will show you compatible profiles. Explore and find your match!</p></div>
            <div class="step"><h3>3. Connect and move in</h3><p>Use our secure messaging to get to know each other and plan your cohabitation.</p></div>
        </div>
    </section>
  </div>
`;

const profilesTemplate = () => {
    const budgetDisplay = state.profileFilters.maxBudget ? `Up to €${state.profileFilters.maxBudget}` : 'Any budget';
    
    return html`
    <div class="container">
        <h1 class="page-title">Find your Roomie</h1>
        <div class="card filter-card">
            <h2 class="filter-title">Filters</h2>
            <div class="filter-controls">
                <div class="filter-group">
                    <label class="filter-label">Features:</label>
                    </div>
                <div class="filter-group">
                    <label for="budget-filter" class="filter-label">Max budget: <span class="budget-display">${budgetDisplay}</span></label>
                </div>
            </div>
             <button @click=${resetFilters} class="btn btn-secondary btn-small">Clear Filters</button>
        </div>
        </div>
    `;
};
    </script>
</body>
</html>
